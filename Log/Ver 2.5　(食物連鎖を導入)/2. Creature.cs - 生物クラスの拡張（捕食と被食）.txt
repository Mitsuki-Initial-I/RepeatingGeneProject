using System;

public class Creature
{
    public float energy = 100f;
    public float hunger = 100f;
    public DietType dietType;
    public Emotion emotions;
    public Morality morality;
    public AIThoughtProcess thoughtProcess;

    public Creature(DietType diet)
    {
        dietType = diet;
        emotions = new Emotion();
        morality = new Morality();
        thoughtProcess = new AIThoughtProcess();
    }

    public void Update(float deltaTime, Environment environment, Creature[] otherCreatures)
    {
        // AIの思考プロセスを呼び出して、新しい行動を発想
        thoughtProcess.Think(environment, this);

        // 捕食行動: 他の生物を見つけて食べられるかどうかを判断
        foreach (var other in otherCreatures)
        {
            if (this != other && FoodChain.CanEat(this, other))
            {
                PerformAction("Hunt", other);
                break;  // 他の生物を捕食したら一旦終了
            }
        }

        // その他の行動
        List<string> availableActions = thoughtProcess.GetAvailableActions();
        string chosenAction = availableActions[new Random().Next(availableActions.Count)];
        
        PerformAction(chosenAction, null);
    }

    public void PerformAction(string action, Creature target)
    {
        Console.WriteLine("Performing action: " + action);

        switch (action)
        {
            case "Move":
                Console.WriteLine("Moving...");
                break;
            case "SeekFood":
                Console.WriteLine("Seeking food...");
                break;
            case "Hunt":
                if (target != null)
                {
                    Console.WriteLine("Hunting and eating: " + target);
                    // 捕食後のエネルギー回復
                    energy += 50f;
                    target.energy = 0f;  // 捕食された生物はエネルギーがゼロになる
                }
                break;
            case "Sleep":
                Console.WriteLine("Sleeping...");
                break;
            case "Mate":
                Console.WriteLine("Mating...");
                break;
            default:
                Console.WriteLine("Unknown action.");
                break;
        }
    }
}
